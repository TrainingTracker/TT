
<link href="~/StyleSheets/CourseEditor.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />


<div class="col-sm-3" >
    <div class="panel panel-primary" id="courses-list-panel">

        <div class="panel-heading">
            <h4 class="panel-title">
                Content
            </h4>
        </div>

        <div class="panel-body">

            <form class="input-div" data-bind="submit: addCourse">
                <input type="text" placeholder="Add Topic" data-bind='value: courseToAdd.Name, valueUpdate: "afterkeydown"'>
                <button type="submit" class="btn btn-sm btn-primary"><i class="fa fa-plus" aria-hidden="true" ></i></button>
            </form>

            <div class="panel-group" id="subtopic-div" data-bind="foreach: courses">
                <div class="panel panel-default" >
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" data-parent="#subtopic-div" data-bind="attr: { href: '#course-collapse' + Id }, text: Name">
                            </a>
                            <span class="pull-right">
                                <a class="fa fa-pencil" data-toggle="collapse" data-parent="#subtopic-div" data-bind="attr: { href: '#course-edit-collapse' + Id }">
                                </a>
                            </span>
                        </h4>
                    </div>
                        
                    @*List of subtopics panel*@
                    <div class="panel-collapse collapse" data-bind="attr: { id: 'course-collapse' + Id }">
                        <form class="input-div" data-bind="submit : $parent.addSubtopic">
                            <input type="text" placeholder="Add Topic" data-bind="value: SubtopicNameToAdd"/>
                            <button type="submit" class="btn btn-sm btn-primary" data-bind="click: $parent.addSubtopic"><i class="fa fa-plus" aria-hidden="true" ></i></button>
                        </form>

                        <div class="list-group" data-bind="foreach: CourseSubtopics">
                            <a data-bind="click: $root.getSubtopicContents, text: Name" class="list-group-item"></a>
                        </div>

                    </div>
                    
                        @*Editor for course panel*@
                    <div class="panel-collapse collapse" data-bind="attr: { id: 'course-edit-collapse' + Id }">
                        <form enctype="multipart/form-data" id="course-icon-upload-form" data-bind="submit: $root.uploadImage">
                               
                            <img data-bind="attr: { src: IconUrl() }" alt="Image not found!" />
                            <input type="file" data-bind="attr: { id: 'form-file' + Id }" accept="image/*" />
                            <ul>
                                <li><label data-bind="attr: {for :'form-file' + Id}" >Choose Image</label></li>
                                <li><button type="submit" class="btn btn-warning btn-sm" ><i class="fa fa-cloud-upload" aria-hidden="true"></i>Upload</button></li>
                            </ul>
                        </form>
                        <form data-bind="submit: $parent.updateCourse" class="course-editor-form" >
                            <input type="text" placeholder="Add Topic" data-bind="value: Name"/>
                            
                            <textarea placeholder ="Add Description" data-bind="value: Description"></textarea>
                            <button class="btn btn-sm btn-warning " data-toggle="collapse" data-bind="attr: { href: '#course-edit-collapse' + Id }" ><i class="fa fa-times"></i></button>
                            <button type="submit" class="btn btn-primary btn-sm"  data-toggle="collpase"  data-bind="attr: { href: '#course-edit-collapse' + Id }, click: $parent.updateCourse" ><i class="fa fa-check"></i></button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="col-sm-9">
    <div class="row">
        @*Current subtopic*@
        <div class="col-sm-9" >
            <div class="panel panel-default">
                <div class="panel-heading">
                    Subtopic Editor
                </div>
                <div class="panel-body"  data-bind="visible: currentSubtopic.IsVisible()">
                    <div class="form-group">
                        <label>Subtopic Name:</label>
                        <input type="text" class="form-control" data-bind="value: currentSubtopic.Name" placeholder="Name">
                    </div>          
                    
                    <div class="form-group">
                      <label>Description:</label>
                      <textarea rows="5" id="subtopic-ckeditor" data-bind="CKEDITOR: currentSubtopic.Description" class="form-control" placeholder="Description"></textarea>
                      
                    </div>
                </div>

                <div class="panel-body" data-bind="visible: currentSubtopic.IsVisible() == false">
                    No Subtopic Selected
                </div>

                <div class="panel-footer" data-bind="visible: currentSubtopic.IsVisible()">
                    <button class="btn btn-primary" data-bind="click: updateSubtopic">Save</button>
                    <button class="btn btn-danger" data-bind="click: deleteSubtopic">Delete</button>
                </div>
            </div>

        </div>
        
        @*  List of links*@
        <div class="col-sm-3 pull-right">
            <div class="panel panel-default" data-bind="visible: currentSubtopic.IsVisible()">
                  <div class="panel-heading" data-bind="text: currentSubtopic.Name"></div>
                  <div class="panel-body">
                    <ul class="list-group" data-bind="foreach: currentSubtopicContents()">
                      <li class="list-group-item" data-bind="text: Name() == ''? 'Add New' : Name(), click: $root.editSubtopicContent"></li>
                    </ul>
                  </div>
            </div>
        </div>
    
    
        @*SubtopicContent Editor*@
        <div class="col-sm-9 pull-left" >
            <div class="panel panel-default">

                <div class="panel-heading">
                    Subtopic Content Editor
                </div>

                <div class="panel-body" data-bind="visible: selectedSubtopicContent.IsVisible()">
                    <div class="form-group">
                        <label>Heading:</label>
                        <input type="text" class="form-control"data-bind="value: selectedSubtopicContent.Name(), valueUpdate : 'afterkeydown'"/>
                    </div>

                    <div class="form-group">
                        <label>Url:</label>
                        <input type="text" class="form-control"data-bind="value: selectedSubtopicContent.Url()"/>
                    </div>

                    <div class ="form-group">
                        <label>Description:</label>
                        <textarea rows="5" id ="content-ckeditor" class="form-control" data-bind=" CKEDITOR: selectedSubtopicContent.Description"></textarea>
                    </div>
                    
                    <div class ="form-group">
                        <label>Assignments:</label>
                        <select data-bind="options: currentAssignments"></select>
                    </div>
                </div>
            
                <div class="panel-body" data-bind="visible: !selectedSubtopicContent.IsVisible()">
                    No contents to edit
                </div>

                <div class="panel-footer" data-bind="visible: selectedSubtopicContent.IsVisible()">
                    <button data-bind="visible: selectedSubtopicContent.Id() > 0, click: updateSubtopicContent" class="btn btn-primary">Save</button>
                    <button data-bind="visible: selectedSubtopicContent.Id() == 0, click: addSubtopicContent" class="btn btn-primary">Add</button>
                    <button data-bind="visible: selectedSubtopicContent.Id() > 0, click: deleteSubtopicContent" class="btn btn-danger">Delete</button>
                </div>
            </div>
        </div>
          
    </div>
</div>


@*<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/knockout-sortable/1.0.0/knockout-sortable.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>*@
<script src="//cdn.ckeditor.com/4.6.0/standard/ckeditor.js"></script>

@section Scripts
{
    @Scripts.Render("~/bundles/CourseEditorViewScripts")
}
