@{
    ViewBag.Title = "Profile";
}

@section Styles
{

    <link href='https://fonts.googleapis.com/css?family=Orbitron' rel='stylesheet' type='text/css'>
    @Styles.Render("~/bundles/ProfileViewStyles")
}

<div class="container-fluid">
    <div class="col-xs-12 no-right-margin no-left-margin layout-wrapper">
        <div id="divUserDetails" class="col-xs-12 col-md-3 no-padding-left no-padding-right ">
            <div class="col-xs-12 no-padding-left no-padding-right">
                <div class="panel-heading">
                    <img data-bind="attr: { src: my.profileVm.userVm.User.PhotoUrl }"
                         class="img-responsive img-circle profile-img">
                    <div data-bind="text: my.profileVm.userVm.User.FullName"
                         class="username">
                    </div>
                    <div data-bind="text: my.profileVm.userVm.User.Designation"
                         class="designation">
                    </div>
                    <div data-bind="text: my.profileVm.userVm.User.Email"
                         class="designation">
                    </div>
                    <div class="designation"
                         data-bind="css: {
                                        'rating-slow': my.profileVm.userVm.User.UserRating == 1,
                                            'rating-Average': my.profileVm.userVm.User.UserRating == 2,
                                            'rating-Fast': my.profileVm.userVm.User.UserRating == 3,
                                            'rating-Exceptional': my.profileVm.userVm.User.UserRating == 4
                                        }">
                        <!-- ko foreach: new Array(my.profileVm.userVm.User.UserRating)  -->
                        <span class="glyphicon glyphicon-star"
                              style="display: inline-block;"></span>
                        <!-- /ko -->
                    </div>
                </div>

                <div id="divWeeklyReviewcollapasable" class="collapse in" data-bind="if: my.profileVm.userVm.User.IsTrainee">
                    <div class="panel-heading">
                        <div class="tab-wrap">
                            <div>
                                <span class="header-Tab">Weekly Feedbacks</span>
                                <span class="header-Tab">CR</span>
                            </div>
                        </div>
                        <div class="tab-wrap rating-Exceptional">
                            <div>
                                @*<span class="header-Tab rating-Exceptional">Exceptional</span>*@
                                @*<span class="header-Tab rating-Exceptional">Exceptional</span>*@
                            </div>
                            <div class="data-counter rating-Exceptional">
                                <span class="rating-exceptional-new-color" data-bind="text: my.profileVm.userVm.TraineeSynopsis.WeeklyFeedbackCount.Exceptional"></span>
                                <span class="rating-tag rating-exceptional-new-color">Exceptional</span>
                                <span class="rating-exceptional-new-color" data-bind="text: my.profileVm.userVm.TraineeSynopsis.CodeReviewFeedbackCount.Exceptional"></span>
                            </div>

                        </div>
                        <div class="tab-wrap">
                            <div>
                                @*<span class="header-Tab rating-Fast">Fast</span>
                                    <span class="header-Tab  rating-Fast">Fast</span>*@
                            </div>
                            <div class="data-counter">
                                <span class=" rating-Fast-new-color" data-bind="text: my.profileVm.userVm.TraineeSynopsis.WeeklyFeedbackCount.Fast"></span>
                                <span class="rating-tag rating-Fast-new-color">Fast</span>
                                <span class=" rating-Fast-new-color" data-bind="text: my.profileVm.userVm.TraineeSynopsis.CodeReviewFeedbackCount.Fast"></span>
                            </div>
                        </div>
                        <div class="tab-wrap">
                            <div>
                                @*<span class="header-Tab rating-Average">Average </span>
                                    <span class="header-Tab rating-Average">Average</span>*@
                            </div>
                            <div class="data-counter">
                                <span class=" rating-Average" data-bind="text: my.profileVm.userVm.TraineeSynopsis.WeeklyFeedbackCount.Average"></span>
                                <span class="rating-tag rating-Average">Average</span>
                                <span class=" rating-Average" data-bind="text: my.profileVm.userVm.TraineeSynopsis.CodeReviewFeedbackCount.Average"></span>
                            </div>
                        </div>
                        <div class="tab-wrap">
                            <div>
                                @*<span class="header-Tab rating-slow">Slow</span>
                                    <span class="header-Tab  rating-slow">Slow</span>*@
                            </div>
                            <div class="data-counter">
                                <span class=" rating-slow" data-bind="text: my.profileVm.userVm.TraineeSynopsis.WeeklyFeedbackCount.Slow"></span>
                                <span class="rating-tag    rating-slow">Slow</span>
                                <span class=" rating-slow" data-bind="text: my.profileVm.userVm.TraineeSynopsis.CodeReviewFeedbackCount.Slow"></span>

                            </div>
                        </div>
                        <div class="tab-wrap">
                            <div>
                                <span class="header-Tab">Recent WF</span>
                                <span class="header-Tab">Recent CR</span>
                            </div>
                            <div data-bind="">
                                <!-- ko if: my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating > 0 -->
                                <span data-bind="visible: my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating > 0, css: {
                                                    'rating-slow': my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating == 1,
                                                    'rating-Average': my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating == 2,
                                                    'rating-Fast-new-color': my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating == 3,
                                                    'rating-Exceptional': my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating == 4
                                                }">
                                    <!-- ko foreach: new Array(my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating)  -->
                                    <span class="glyphicon glyphicon-star"
                                          style="display: inline-block;"></span>
                                    <!-- /ko -->
                                </span>
                                <!-- /ko -->
                                <!-- ko if: my.profileVm.userVm.TraineeSynopsis.RecentWeeklyRating == 0 -->
                                <span>--</span>
                                <!-- /ko -->
                                <!-- ko if: my.profileVm.userVm.TraineeSynopsis.RecentCodeReviewRating > 0 -->
                                <span data-bind=" css: {
                                                        'rating-slow': my.profileVm.userVm.TraineeSynopsis.RecentCodeReviewRating == 1,
                                                        'rating-Average': my.profileVm.userVm.TraineeSynopsis.RecentCodeReviewRating == 2,
                                                        'rating-Fast-new-color': my.profileVm.userVm.TraineeSynopsis.RecentCodeReviewRating == 3,
                                                        'rating-Exceptional': my.profileVm.userVm.TraineeSynopsis.RecentCodeReviewRating == 4
                                                    }">
                                    <!-- ko foreach: new Array(my.profileVm.userVm.TraineeSynopsis.RecentCodeReviewRating)  -->
                                    <span class="glyphicon glyphicon-star"
                                          style="display: inline-block;"></span>
                                    <!-- /ko -->
                                </span>
                                <!-- /ko -->
                                <!-- ko if: my.profileVm.userVm.TraineeSynopsis.RecentCodeReviewRating == 0 -->
                                <span>--</span>
                                <!-- /ko -->
                            </div>

                        </div>

                    </div>
                </div>

                <div class="list-group " data-bind="if: my.profileVm.userVm.User.IsTrainee && my.profileVm.userVm.AllAssignedCourses.length > 0" data-toggle="collapse" data-target="#divCoursescollapasable">
                    <div class="list-group-item active">
                        <label>Courses Assigned</label>
                        <span class="pull-right">
                            <i class="glyphicon  glyphicon-chevron-down custom-glyph"></i>
                        </span>
                    </div>
                </div>

                <div id="divCoursescollapasable" class="collapse in" data-bind="if: my.profileVm.userVm.User.IsTrainee && my.profileVm.userVm.AllAssignedCourses.length > 0">
                    <div data-bind="foreach: my.profileVm.userVm.AllAssignedCourses">
                        <div class="list-group-item collapse" data-bind="click: function(){ my.profileVm.navigateToCourse(Id); }">
                            <span data-bind="text:Name"></span>
                            <span class="pull-right" data-bind="text: PercentageCompleted"></span>
                            <span class="pull-right">
                                Redirect to Course   <i class="fa fa-external-link custom-glyph"></i>
                            </span>
                        </div>
                        <i data-bind="visible: PendingAssignmentCount > 0" class="fa fa-exclamation pending-assignment pull-right" aria-hidden="true">
                            <span class="badge" data-bind="text: PendingAssignmentCount"></span>
                            <span class="custom-tooltip" data-bind="text:PendingAssignmentCount + ' pending assignment to approve'"></span>
                        </i>

                    </div>
                </div>


                <div class="list-group collapsed" data-bind="if: my.profileVm.userVm.User.IsTrainee" data-toggle="collapse" data-target="#divSkillscollapasable">
                    <div class="list-group-item active">
                        <label>Skills</label>
                        <span class="pull-right">
                            <i class="glyphicon glyphicon-chevron-down custom-glyph"></i>
                        </span>
                    </div>
                </div>
                <div id="divSkillscollapasable" class="collapse" data-bind="if: my.profileVm.userVm.User.IsTrainee">
                    <div data-bind="foreach: my.profileVm.userVm.Skills">
                        <div class="list-group-item">
                            <div data-bind="text: Name" style="display: inline-block;"></div>
                            <div class="pull-right" style="display: inline-block;">
                                <div data-bind="css: {
                                                            'rating-slow': Rating == 1,
                                                            'rating-Average': Rating == 2,
                                                            'rating-Fast': Rating == 3,
                                                            'rating-Exceptional': Rating == 4
                                                        }">
                                    <!-- ko foreach: new Array(Rating)  -->
                                    <span class="glyphicon glyphicon-star"
                                          style="display: inline-block;"></span>
                                    <!-- /ko -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div data-bind="visible: my.profileVm.userVm.Skills.length == 0">
                        <div class="list-group-item">
                            <span>No Skills added for Trainee</span>
                        </div>
                    </div>

                </div>



                <div class="list-group collapsed" data-bind="if: my.profileVm.userVm.User.IsTrainee" data-toggle="collapse" data-target="#divSessioncollapasable">
                    <div class="list-group-item active">
                        <label>Sessions attended</label>
                        <span class="pull-right">
                            <i class="glyphicon  glyphicon-chevron-down custom-glyph"></i>
                        </span>
                    </div>
                </div>

                <div id="divSessioncollapasable" class="collapse" data-bind="if: my.profileVm.userVm.User.IsTrainee">
                    <div data-bind="foreach: my.profileVm.userVm.Sessions">
                        <div data-bind="text: Title" class="list-group-item collapse"></div>
                    </div>
                    <div data-bind="visible: my.profileVm.userVm.Sessions.length == 0">
                        <div class="list-group-item collapse"><span>No Sessions Attended</span></div>
                    </div>
                </div>

                <div id="divReviewcollapasable" class="collapse in" data-bind="if: (my.profileVm.userVm.User.IsTrainer || my.profileVm.userVm.User.IsManager)">
                    <div class="panel-heading">
                        <div class="tab-wrap">
                            <div>
                                <span class="header-Tab">Weekly Feedbacks</span>
                                <span class="header-Tab">CR</span>
                            </div>
                            <div class="data-counter">
                                <span data-bind="text: my.profileVm.trainorSynopsis().WeeklyFeedbackCount"></span>
                                <span data-bind="text: my.profileVm.trainorSynopsis().CodeReviewFeedbackCount"></span>
                            </div>

                        </div>
                        <div class="tab-wrap">
                            <div>
                                <span class="header-Tab">Assignments</span>
                                <span class="header-Tab">Skills</span>
                            </div>
                            <div class="data-counter">
                                <span data-bind="text: my.profileVm.trainorSynopsis().AssignmentFeedbackCount"></span>
                                <span data-bind="text: '--'"></span>
                            </div>
                        </div>
                        <div class="tab-wrap">
                            <div>
                                <span class="header-Tab">Exceptional Ratings</span>
                                <span class="header-Tab">Fast Ratings</span>
                            </div>
                            <div class="data-counter">
                                <span data-bind="text: my.profileVm.trainorSynopsis().ExceptionalFeedbackCount"></span>
                                <span data-bind="text: my.profileVm.trainorSynopsis().FastFeedbackCount"></span>
                            </div>
                        </div>
                        <div class="tab-wrap">
                            <div>
                                <span class="header-Tab">Average Ratings</span>
                                <span class="header-Tab">Slow Ratings</span>
                            </div>
                            <div class="data-counter">
                                <span data-bind="text: my.profileVm.trainorSynopsis().AverageFeedbackCount"></span>
                                <span data-bind="text: my.profileVm.trainorSynopsis().SlowFeedbackCount"></span>

                            </div>
                        </div>

                    </div>
                </div>

            </div>
        </div>
        <div class="col-xs-12 col-md-9 custom-margin-top-10" data-bind="visible: my.profileVm.userVm.User.IsTrainee">
            <ul class="nav nav-tabs custom-nav-tab" role="tablist">
                <li role="presentation" class="active">
                    <a href="#divFeedbackArea" aria-controls="divFeedbackArea" role="tab" data-toggle="tab"><i class="fa fa-bullhorn" aria-hidden="true"></i> Feedbacks</a>
                </li>
                <li role="presentation" data-bind=" click: function () { my.profileVm.loadPlotData(); }">
                    <a href="#divFeedbackChart" aria-controls="divFeedbackChart" role="tab" data-toggle="tab"><i class="fa fa-bar-chart" aria-hidden="true"></i> Synopsis</a>
                </li>

                <li role="presentation" data-bind=" click: my.discussionForumVm.getPosts">
                    <a href="#divDiscussionArea" role="tab" data-toggle="tab"><i class="fa fa-commenting-o" aria-hidden="true"></i> Discussions</a>
                </li>


            </ul>
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="divFeedbackArea">
                    @if (HttpContext.Current.User.IsInRole("Manager") || HttpContext.Current.User.IsInRole("Trainer"))
                    {
                        <div class="panel panel-white post panel-shadow" data-bind="visible: !my.profileVm.currentUser.IsTrainee">
                            <div class="post-heading">
                                <div class="image col-xs-12 col-md-1 no-right-margin">
                                    <img data-bind="attr: { src: my.profileVm.currentUser.avatarUrl }"
                                         class="img-circle avatar" alt="user profile image">
                                </div>
                                <div class="feedback-input meta  col-xs-12 col-md-2 no-right-margin">
                                    <label>Feedback Type:</label>
                                    <select id="selFeedbackType" class="input-sm form-control" data-bind="options: my.profileVm.feedbackTypes.NewFeedback,
                                                                                                              optionsText: 'Description',
                                                                                                              optionsValue: 'FeedbackTypeId',
                                                                                                              value: my.profileVm.feedbackPost.selectedOption"></select>
                                </div>
                                <div class="col-xs-12 col-md-4  no-right-margin no-left-margin">
                                    <div data-bind="visible: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId == 2 " class=" col-xs-12 col-md-12 no-right-margin feedback-input meta">
                                        <label>Skill:</label>
                                        <label class="radio-inline">
                                            <input value="1" data-bind="checked: my.profileVm.controls.skillOption" type="radio" name="optradio">Select existing
                                        </label>
                                        <label class="radio-inline">
                                            <input value="2" data-bind="checked: my.profileVm.controls.skillOption" type="radio" name="optradio">Other
                                        </label>
                                        <select class="input-sm form-control" data-bind="visible: my.profileVm.controls.skillOption() == 1, options: my.profileVm.userVm.AllSkills(),
                                                                                             optionsText: 'Name',
                                                                                             value: my.profileVm.selectedSkill"></select>
                                        <input type="text"
                                               data-bind="visible: my.profileVm.controls.skillOption() == 2, value: my.profileVm.feedbackPost.Title"
                                               class="input-sm form-control"
                                               placeholder="Enter skill title" />
                                    </div>
                                    <div data-bind="visible: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId == 3 " class=" col-xs-12 col-md-12 no-right-margin feedback-input meta">
                                        <label>Assignment:</label>
                                        <input type="text"
                                               data-bind="value: my.profileVm.feedbackPost.Title"
                                               class="input-sm form-control"
                                               placeholder="enter assignment title" />

                                    </div>

                                    <div data-bind="visible: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId == 5 " class=" col-xs-12 col-md-12 no-right-margin feedback-input meta">
                                        <label>Select date range:</label><span class="pull-right glyphicon glyphicon-comment" data-bind="visible: (my.profileVm.feedbackPost.EndDate() && my.profileVm.feedbackPost.StartDate()), click: my.profileVm.showCommentFeedback, wzTooltip: { tittle: 'Display comments for selected date range.', HtmlTag: 'false', ClickSticky: 'false', Above: 'true' }" style="cursor: pointer; color: #31b0d5"></span>
                                        <div class="input-daterange input-group" id="datepicker">
                                            <input type="text" data-bind="datepicker: my.profileVm.feedbackPost.StartDate, endDate: new Date(), value: my.profileVm.feedbackPost.StartDate" class="date-picker input-sm form-control" name="start" />
                                            <span class="input-group-addon">to</span>
                                            <input type="text" data-bind="datepicker: my.profileVm.feedbackPost.EndDate, endDate: new Date(), value: my.profileVm.feedbackPost.EndDate" class="date-picker input-sm form-control" name="end" />
                                        </div>
                                    </div>
                                </div>
                                <div data-bind="visible: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId != 1 " class="feedback-input meta col-xs-12 col-md-5  no-right-margin no-left-margin">
                                    <label class="col-xs-12 col-md-12 ">Rating:</label>
                                    <br />
                                    <div class="btn-group col-xs-12 col-md-12 no-right-margin">
                                        <button data-bind="click: my.profileVm.setRating(1)"
                                                type="button"
                                                class="btn btn-sm btn-danger col-xs-3">
                                            Slow <i data-bind="visible: my.profileVm.feedbackPost.Rating() == 1" class="glyphicon glyphicon-ok"></i>
                                        </button>
                                        <button data-bind="click: my.profileVm.setRating(2)"
                                                type="button"
                                                class="btn btn-sm  btn-warning col-xs-3">
                                            Avg. <i data-bind="visible: my.profileVm.feedbackPost.Rating() == 2" class="glyphicon glyphicon-ok"></i>
                                        </button>
                                        <button data-bind="click: my.profileVm.setRating(3)"
                                                type="button"
                                                class="btn btn-sm  btn-primary col-xs-3">
                                            Fast <i data-bind="visible: my.profileVm.feedbackPost.Rating() == 3" class="glyphicon glyphicon-ok"></i>
                                        </button>
                                        <button data-bind="click: my.profileVm.setRating(4)"
                                                type="button"
                                                class="btn btn-sm  btn-success col-xs-3">
                                            Exp. <i data-bind="visible: my.profileVm.feedbackPost.Rating() == 4" class="glyphicon glyphicon-ok"></i>
                                        </button>
                                    </div>
                                </div>

                            </div>

                            @* For Weekly Feedback *@

                            <div id="wizard" data-bind="visible: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId == 5, wizardControl: my.profileVm.surveyQuestion(),
                                                            animation: 'slide',
                                                            orientation: 'vertical',
                                                            wizardStepCallback: my.profileVm.wizardOnStepChanging,
                                                            wizardOnStepChanged: my.profileVm.wizardOnStepChanged,
                                                            wizardOnSubmit: my.profileVm.wizardOnSubmit,
                                                            loadPreviewFunction: my.profileVm.loadFeedbackPreview ">
                                @* Binding handler will fill this Question *@
                            </div>

                            @* For Code Review Feedback *@

                            <div id="CodeReviewSection" data-bind="visible: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId == 4">

                                <div id="divCodeReviewProjectData" class="col-xs-12">
                                    <div class="col-xs-6 no-padding-left">
                                        <div class="feedback-input meta  col-xs-12  no-padding-left no-padding-right">
                                            <label>Project/Assignment Title</label>
                                            <input type="text" placeholder="Project/Assignment Name" class="input-sm form-control" data-bind="text:my.profileVm.codeReviewDetails.Title" />
                                        </div>
                                        <div class="feedback-input meta  col-xs-12 no-padding-left no-padding-right">
                                            <label>Description</label>
                                            <textarea rows="1" style="resize:none" placeholder="This review is about? this review covers?" class="input-sm form-control" data-bind="text:my.profileVm.codeReviewDetails.Description"></textarea>
                                        </div>
                                    </div>
                                    <div class="col-xs-6">
                                        <div class="feedback-input meta  col-xs-12 no-padding-left no-padding-right">
                                            <label>Tech. Stack:</label>
                                            <select class="input-sm form-control"
                                                    style="font-size:13px;"
                                                    multiple="multiple"
                                                    size="4"
                                                    data-bind="options: my.profileVm.userVm.AllSkills(),
                                                               optionsText: 'Name' ,
                                                               selectedOptions : my.profileVm.codeReviewDetails.Skills "></select>
                                        </div>
                                    </div>
                                </div>

                                <div id="divCodeReviewSkillsWizard" class="col-xs-12">
                                    <div class="col-xs-2 no-padding-left" id="divCrWizard">
                                        <div class="col-xs-12 no-padding-left no-padding-right code-review-steps current-selected-tab">
                                            <span>General</span>
                                        </div>
                                        <!-- ko foreach: my.profileVm.codeReviewDetails.Skills  -->
                                        <div class="col-xs-12 no-padding-left no-padding-right code-review-steps">
                                            <span data-bind="text:Name"></span>
                                        </div>
                                        <!-- /ko -->
                                    </div>
                                    <div class="col-xs-10 no-padding-right" id="divCrPointsArea">
                                        <div class="col-xs-12 no-padding-left no-padding-right" id="divCrWizardTagPreview">

                                        </div>
                                        <div class="col-xs-10 no-padding-left no-padding-right" id="divCrWizardTagPoints">
                                            <div class="feedback-input meta  col-xs-12  no-padding-left no-padding-right">
                                                <label>Review Point</label>
                                                <input type="text" placeholder="eg : Folder structure not clean" class="input-sm form-control" data-bind="text:my.profileVm.codeReviewPoints.Title" />
                                            </div>
                                            <div class="feedback-input meta  col-xs-12 no-padding-left no-padding-right">
                                                <label>Additional Details</label>
                                                <textarea id="txtAreaFeedback" data-bind="CKEDITOR: my.profileVm.codeReviewPoints.Description"
                                                          class="form-control comment-input-control" rows="3" type="text" placeholder="Enter feedback" style= resize: vertical"></textarea>
                                            </div>
                                        </div>
                                        <div class="col-xs-2 no-padding-right" id="divCrWizardPointsRatings">
                                            <!-- ko foreach: my.profileVm.codeReviewPointsTypes  -->
                                            <div class="col-xs-12 no-padding-left no-padding-right cr-ratings" data-bind="css:'code-review-rating-'+Title">
                                                <span data-bind="text:Title"></span>
                                                <i class="glyphicon glyphicon-ok"></i>
                                            </div>
                                            <!-- /ko -->

                                            <button  style="height: 34px;" type="button" class="form-control btn btn-info  input-sm ">Add Point <i class="glyphicon glyphicon-plus"></i></button>
                                        </div>

                                    </div>
                                </div>

                            </div>

                            @* For Rest Feedback *@
                            <div class="no-right-margin no-left-margin post-description comment-div"
                                 data-bind="visible: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId != 5 && my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId != 4">
                                <div data-bind="if: my.profileVm.feedbackPost.FeedbackType().FeedbackTypeId != 4" class="col-xs-12 col-md-12 no-right-margin ">
                                    <textarea data-bind=" value: my.profileVm.feedbackPost.FeedbackText, autoResizeTextArea: true"
                                              class="form-control comment-input-control" rows="3" type="text" placeholder="Enter feedback" style="max-height: 57vh; resize: vertical"></textarea>
                                </div>
                                <div class="col-xs-12 col-md-11 ">
                                    <label data-bind="text: my.profileVm.validationMessage" class="validation-error"></label>
                                </div>

                                <div class="comment-send col-xs-12 col-md-1 col-lg-1 no-left-margin no-right-margin">
                                    <button data-bind="click: my.profileVm.addFeedback" type="button" class="btn btn-info pull-right">Add <i class="glyphicon glyphicon-send"></i></button>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                    }

                    <div class="col-xs-12 col-md-12 no-left-margin no-right-margin panel panel-white post panel-shadow">
                        <div class="post-heading">
                            <div class="col-xs-12 col-md-2 feedback-input meta">
                                <label class="">Feedback Count:</label>
                                <select class=" input-sm form-control" data-bind="options: my.profileVm.filter.pageSize, value: my.profileVm.filter.selectedPageSize"></select>
                            </div>
                            <div class="col-xs-12 col-md-2 feedback-input meta">
                                <label class="">Feedback Type:</label>
                                <select class=" input-sm form-control" data-bind="options: my.profileVm.feedbackTypes.Filter,
                                                                                      optionsText: 'Description',
                                                                                      value: my.profileVm.filter.filterFeedback, optionsCaption: 'All'"></select>
                            </div>
                            @*<div class="pull-left feedback-input meta">
                                </div>
                            *@
                            <div class="col-xs-12 col-md-3 col-md-offset-5  feedback-input meta">
                                <label style="visibility: hidden">Apply Filter</label>
                                <button data-bind=" click: my.profileVm.applyFilter " style="height: 34px;" type="button" class="form-control btn btn-info  input-sm ">Apply Filter <i class="glyphicon glyphicon-filter"></i></button>
                            </div>
                        </div>
                    </div>


                    <div id="feedbackSection" class="col-xs-12 col-md-12 no-left-margin no-right-margin" data-bind="foreach: my.profileVm.userVm.Feedbacks">
                        <div class="panel panel-white post panel-shadow">
                            <div class="post-heading">
                                <div class="pull-left image">
                                    <img data-bind="attr: { src: AddedBy.UserImageUrl }"
                                         class="img-circle avatar" alt="user profile image">
                                </div>
                                <div class="pull-left meta">
                                    <div class="title h5" style="display: inline-block;">
                                        <strong><a data-bind="text: AddedBy.FullName, attr: { href: my.rootUrl + '/Profile/UserProfile?userId=' + AddedBy.UserId }"></a></strong>
                                    </div>
                                    <div data-bind="text: 'Added ' + FeedbackType.Description + ' Feedback'" class="text-muted time" style="display: inline-block;"></div>
                                    <div style="display: inline-block; padding-left: 10px"
                                         data-bind="css: {
                                                            'rating-slow': Rating == 1,
                                                            'rating-Average': Rating == 2,
                                                            'rating-Fast': Rating == 3,
                                                            'rating-Exceptional': Rating == 4
                                                        }">
                                        <!-- ko foreach: new Array(Rating)  -->
                                        <span class="glyphicon glyphicon-star"
                                              style="display: inline-block;"></span>
                                        <!-- /ko -->
                                    </div>
                                    <h6 data-bind="text: moment(AddedOn).format('MMMM Do YYYY, h:mm a')" class="text-muted time"></h6>
                                    <h6 data-bind="visible: FeedbackType.FeedbackTypeId != 5, text: Title" class="text-muted time"></h6>
                                    <h6 data-bind="visible: FeedbackType.FeedbackTypeId == 5, text: 'Feedback Week : ' + moment(StartDate).format('Do MMMM YYYY') + ' - ' + moment(EndDate).format('Do MMMM YYYY')" class="text-muted time"></h6>
                                </div>
                                <div class="pull-right" style="display: inline-block;">
                                    <button type="button" class="form-control btn btn-info  input-sm " data-bind="click: function () { my.profileVm.loadFeedbackWithThread(FeedbackId) }">
                                        <i class=" badge " style="color: red; font-style: normal;" data-bind="text: ThreadCount"></i><span class="">Add/View Notes </span>
                                    </button>
                                </div>
                            </div>
                            <div class="post-description">
                                <p data-bind="visible: (FeedbackType.FeedbackTypeId != 4 && FeedbackType.FeedbackTypeId != 5 && FeedbackType.FeedbackTypeId != 6 ), text: FeedbackText" style="white-space: pre-wrap;"></p>
                                <p data-bind="visible:  FeedbackType.FeedbackTypeId == 4 || FeedbackType.FeedbackTypeId == 5 || FeedbackType.FeedbackTypeId == 6 , html: FeedbackText" style="white-space: pre-wrap;"></p>
                            </div>
                        </div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="divFeedbackChart">
                    <div class="panel panel-white post panel-shadow">
                        <div class="post-heading">
                            <div class="feedback-input meta col-xs-4">
                                <label class="col-xs-12">Start Date:</label>
                                <input type="text" data-bind="datepicker: my.profileVm.plotFilter.StartDate, startDate: my.profileVm.plotFilter.StartDate(), endDate: new Date(), value: my.profileVm.plotFilter.StartDate" class="date-picker input-sm form-control col-xs-12" name="startSynopsis" />
                            </div>
                            <div class="feedback-input meta col-xs-4">
                                <label class="col-xs-12">End Date:</label>
                                <input type="text" data-bind="datepicker: my.profileVm.plotFilter.EndDate, startDate: my.profileVm.plotFilter.StartDate(), endDate: new Date(), value: my.profileVm.plotFilter.EndDate" class="date-picker input-sm form-control col-xs-12" name="endSynopsis" />
                            </div>
                            <div class="feedback-input meta col-xs-4">
                                <label class="col-xs-12">Feedback By:</label>
                                <select class="input-sm form-control" data-bind="options: my.profileVm.tempAllTrainer(),
    optionsText: 'FullName',
    value: my.profileVm.plotFilter.Trainer, optionsCaption: 'All'"></select>
                            </div>
                            <div class="feedback-input meta col-xs-9">
                                <label class="col-xs-12">Include Feedbacks for:</label>
                                <div class="col-xs-4">
                                    <span class="custom-checkbox">
                                        <input type="checkbox" id="ckbCodeReview" data-bind="attr: { value: '4' }, checked: my.profileVm.plotFilter.FeedbackType" />
                                        <span class="box">
                                            <span class="tick"></span>
                                        </span>
                                    </span>
                                    <label for="ckbCodeReview" class=" lblForCheckbox make-checkbox-label-in-align">Code Review</label>
                                </div>
                                <div class="col-xs-4">
                                    <span class="custom-checkbox">
                                        <input type="checkbox" id="ckbWeeklyFeedback" data-bind="attr: { value: '5' }, checked: my.profileVm.plotFilter.FeedbackType" />
                                        <span class="box">
                                            <span class="tick"></span>
                                        </span>
                                    </span>
                                    <label for="ckbWeeklyFeedback" class=" lblForCheckbox make-checkbox-label-in-align">Weekly</label>
                                </div>
                                <div class="col-xs-4">
                                    <span class="custom-checkbox">
                                        <input type="checkbox" id="ckbAssignment" data-bind="attr: { value: '3' }, checked: my.profileVm.plotFilter.FeedbackType" />
                                        <span class="box">
                                            <span class="tick"></span>
                                        </span>
                                    </span>
                                    <label for="ckbAssignment" class=" lblForCheckbox make-checkbox-label-in-align">Assignment</label>
                                </div>
                            </div>
                            <div class="feedback-input meta col-xs-3">
                                <label class="col-xs-12"></label>
                                <button type="button" class="feedback-button form-control btn btn-info  input-sm " data-bind=" click: function () { my.profileVm.loadPlotData(); }">
                                    Draw Plot
                                    <i class="glyphicon glyphicon-stats"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-white post panel-shadow col-xs-12 no-right-margin no-left-margin">
                        <div class=" no-right-margin no-left-margin">
                            @Html.Partial("_FeedbackIllustration")
                        </div>
                    </div>
                </div>


                <div role="tabpanel" class="tab-pane" id="divDiscussionArea">

                    @if (HttpContext.Current.User.IsInRole("Trainee"))
                    {
                        <div class="panel panel-white post panel-shadow">
                            <div class="post-heading">
                                <div class="image col-xs-12 col-md-1 no-right-margin">
                                    <img data-bind="attr: { src: my.profileVm.currentUser.avatarUrl }"
                                         class="img-circle avatar" alt="user profile image">
                                </div>
                                <div class="col-xs-12 col-md-11 no-right-margin " style="margin-top: 25px;">
                                    <input data-bind="value: my.discussionForumVm.newPost.Title" placeholder="Enter Title"
                                           class="form-control" />
                                </div>
                            </div>

                            <div class="no-right-margin no-left-margin post-description comment-div">
                                <div class="col-xs-12 col-md-12 no-right-margin ">
                                    <textarea data-bind="value: my.discussionForumVm.newPost.Description, autoResizeTextArea: true"
                                              class="form-control comment-input-control" rows="3" type="text" placeholder="Enter Description" style="max-height: 57vh; resize: vertical"></textarea>
                                </div>
                                <div class="col-xs-12 col-md-11 ">
                                    <label data-bind="html: my.discussionForumVm.alerts.postValidation" class="validation-error"></label>
                                </div>

                                <div class="comment-send col-xs-12 col-md-1 col-lg-1 no-left-margin no-right-margin">
                                    <button data-bind="click: my.discussionForumVm.validateAndAddPost" type="button" class="btn btn-info pull-right">Post <i class="glyphicon glyphicon-send"></i></button>
                                </div>

                                <div class="clearfix"></div>
                            </div>
                        </div>
                    }


                    <div class="col-xs-12 col-md-12 no-left-margin no-right-margin panel panel-white post panel-shadow">
                        <div class="row" id="divSearch">
                            <div class="col-md-4 no-padding-right ">
                                <div class="col-md-12 no-padding-left no-padding-right">
                                    <div class="form-group">
                                        <select class="form-control" data-bind="value: my.discussionForumVm.filters.statusId, valueUpdate: 'change, keyup', event:{change: function(){my.discussionForumVm.resetAndGetPosts();}}">
                                            <option value="0">All</option>
                                            <option value="1">New</option>
                                            <option value="2">In Discussion</option>
                                            <option value="3">Closed</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="input-group category-list-search">
                                    <input type="text" data-bind="value:my.discussionForumVm.filters.wildcard" class="form-control" placeholder="search by title or description...">
                                    <div class="input-group-btn">
                                        <div id="divSearchBar" class="btn btn-default" data-bind="click:function(){my.discussionForumVm.resetAndGetPosts();}">
                                            <i class="fa fa-search icon-font"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div data-bind="visible: my.discussionForumVm.posts.DisplayPosts().length == 0" class="col-xs-12 col-md-12  panel panel-shadow">
                        <p style="text-align:center">No Discussions Found</p>
                    </div>
                    <div id="discussionSection" class="col-xs-12 col-md-12 no-left-margin no-right-margin" data-bind="foreach: my.discussionForumVm.posts.DisplayPosts">
                        <div class="panel panel-white post panel-shadow">
                            <div class="post-heading">
                                <div class="pull-left image">
                                    <img data-bind="attr: { src: my.discussionForumVm.photoUrl(AddedByUser.ProfilePictureName) }"
                                         class="img-circle avatar" alt="user profile image">
                                </div>
                                <div class="pull-left meta">
                                    <div class="title h5" style="display: inline-block;">
                                        <strong><span data-bind="text: Title"></span></strong>
                                    </div>
                                    <div style="display: inline-block; padding-left: 10px" id="divQuickStatus">
                                        <span class="label label-success " data-bind="text: Status.Title, visible: StatusId == 1"></span>
                                        <span class="label label-info" data-bind="text: Status.Title, visible: StatusId == 2"></span>
                                        <span class="label label-danger " data-bind="text: Status.Title, visible: StatusId == 3"></span>
                                    </div>
                                    <br>
                                    <div class="text-muted time" style="display: inline-block;">
                                        <span>Posted by </span> <a data-bind="text: AddedByUser.FirstName + ' ' + AddedByUser.LastName, attr: { href: my.rootUrl + '/Profile/UserProfile?userId=' + AddedByUser.UserId }"></a>
                                        <span>on</span>
                                        <h6 style="display:inline-block" data-bind="text: moment(CreatedOn).format('MMMM Do YYYY, h:mm a')" class="text-muted time"></h6>
                                    </div>

                                </div>
                                <div class="pull-right" style="display: inline-block;">
                                    <button type="button" class="form-control btn btn-info  input-sm " data-bind="click: function () { my.discussionThreadsVm.loadDiscussionDialog(PostId) }">
                                        <i class=" badge " style="color: red; font-style: normal;"></i><span class="">Add/View Comments </span>
                                    </button>
                                </div>
                            </div>
                            <div class="post-description">
                                <p data-bind="text: Description" style="white-space: pre-wrap;"></p>
                            </div>
                        </div>
                    </div>
                    <div id="divPager">
                        <nav aria-label="..." data-bind="visible: my.discussionForumVm.posts.PageCount() > 1">
                            <ul class="pager" style="margin: 0">
                                <li class="previous" data-bind="visible: my.discussionForumVm.posts.CurrentPage() > 1, click:function(){ my.discussionForumVm.getPreviousPage();}"><a href="#"><span aria-hidden="true">&larr;</span> Previous</a></li>
                                <li class="next" data-bind="visible: my.discussionForumVm.posts.CurrentPage() != my.discussionForumVm.posts.PageCount(), click:function(){ my.discussionForumVm.getNextPage();}"><a href="#">Next <span aria-hidden="true">&rarr;</span></a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

            </div>
        </div>

        <div class="col-xs-12 col-md-9" data-bind="visible: (my.profileVm.userVm.User.IsManager || my.profileVm.userVm.User.IsTrainer)">
            <div id="feedbackSection" class="col-xs-12 col-md-12 no-left-margin no-right-margin" data-bind="foreach: my.profileVm.userVm.Feedbacks">
                <div class="panel panel-white post panel-shadow">
                    <div class="post-heading">
                        <div class="pull-left meta">
                            <div class="title h5" style="display: inline-block;">
                                <strong><a data-bind="text: my.profileVm.userVm.User.FullName, attr: { href: my.rootUrl + '/Profile/UserProfile?userId=' + my.profileVm.userVm.User.UserId }"></a></strong>
                            </div>
                            <div data-bind="text: 'Added ' + FeedbackType.Description + ' Feedback for'" class="text-muted time" style="display: inline-block;"></div>
                            <div class="title h5" style="display: inline-block;">
                                <strong><a data-bind="text: AddedBy.FullName, attr: { href: my.rootUrl + '/Profile/UserProfile?userId=' + AddedBy.UserId }"></a></strong>
                            </div>
                            <h6 data-bind="text: moment(AddedOn).format('MMMM Do YYYY, h:mm a')" class="text-muted time"></h6>
                            <h6 data-bind="visible: FeedbackType.FeedbackTypeId != 5, text: Title" class="text-muted time"></h6>
                            <h6 data-bind="visible: FeedbackType.FeedbackTypeId == 5, text: 'Feedback Week : ' + moment(StartDate).format('Do MMMM YYYY') + ' - ' + moment(EndDate).format('Do MMMM YYYY')" class="text-muted time"></h6>
                        </div>
                        @if (HttpContext.Current.User.IsInRole("Manager") || HttpContext.Current.User.IsInRole("Trainer"))
                        {
                            <div class="pull-right" style="display: inline-block;">
                                <button type="button" class="form-control btn btn-info  input-sm " data-bind="click: function () { my.profileVm.loadFeedbackWithThread(FeedbackId) }">
                                    <span class="">Load Feedback </span>
                                </button>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="divWeeklyComment" class="col-xs-12 col-md-3 " data-bind="css: (my.profileVm.isCommentFeedbackModalVisible() && (!my.profileVm.isCommentCollapsed())) ? 'modal' : '', style: { 'top': 'auto', 'display': 'block' }, fadeVisible: (my.profileVm.isCommentFeedbackModalVisible() && (!my.profileVm.isCommentCollapsed()))">

        <div class="modal-content col-xs-12  no-right-margin" style="max-height: 94vh">
            <div class="modal-header no-left-margin ">
                <h4 class="modal-title col-xs-8  no-left-margin">Weekly Comments</h4>
                <button type="button" class="close" data-bind="click: my.profileVm.closeCommentFeedbackModal" aria-hidden="true">&times;</button>
            </div>
            <div data-bind="visible: my.profileVm.commentFeedbacks().length < 1" class="modal-body col-xs-12  no-left-margin no-right-margin">
                <span>No comments added.</span>
            </div>
            <div data-bind="visible: my.profileVm.commentFeedbacks().length > 0" class="modal-body col-xs-12 no-left-margin no-right-margin" style="overflow-y: scroll; min-height: 50%; max-height: 77vh">
                <div id="" class="col-xs-12 col-md-12 no-left-margin" data-bind="foreach: my.profileVm.commentFeedbacks">
                    <div class="modal-body col-xs-12 col-md-12 no-left-margin no-right-margin" style="padding-bottom: 0; border-bottom: 2px solid #ccc">
                        <div>
                            <span data-bind="text: FeedbackText" style="white-space: pre-wrap;"></span>
                        </div>
                        <div class="modal-body col-xs-12 col-md-12 no-left-margin no-right-margin" style="padding-top: 0;">
                            <div class="col-xs-12 no-left-margin no-right-margin">
                                <span class="pull-right">
                                    ~
                                    <a data-bind="text: AddedBy.FullName, attr: { href: my.rootUrl + '/Profile/UserProfile?userId=' + AddedBy.UserId }"></a>
                                </span>
                            </div>
                            <div class="col-xs-12 no-left-margin no-right-margin">
                                <span class="pull-right" data-bind="text: moment(AddedOn).format('MMMM Do YYYY h:mm a')"></span>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="modal-footer no-left-margin " style="display: table; width: 100%; border: none;">
                <button class="btn btn-info col-xs-4 col-xs-offset-8" data-bind="click: my.profileVm.closeCommentFeedbackModal">Close</button>
            </div>
            <!-- /.modal-content -->
        </div>
    </div>
</div>

@Html.Partial("_FeedbackThread")

@Html.Partial("_DiscussionThread")

@section Scripts
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.2/Chart.js"></script>
    <script src="~/Scripts/ckeditor/ckeditor.js"></script>
    @Scripts.Render("~/bundles/ProfileViewScripts")
}
